import React, { useState, useRef, useEffect } from "react";
import {
  View,
  Text,
  Dimensions,
  PanResponder,
  Animated,
  TouchableOpacity,
  ScrollView,
  Alert,
} from "react-native";
import * as Animatable from "react-native-animatable";
import { SvgXml } from "react-native-svg";

const { width, height } = Dimensions.get("window");

const ASPECT_RATIO = width / height;

const fuelIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="520" height="748" viewBox="0 0 520 748" fill="none">
<path fill-rule="evenodd" clip-rule="evenodd" d="M402.83 90.78L519.71 207.66V494.58C519.71 551.93 501.84 582.97 441 582.97H344.31V649.62H39.27V0.840027H344.31V526.73H441C466.66 526.73 463.46 523.01 463.46 494.58V230.94L363.08 130.55L402.83 90.78ZM0.950012 675.66H382.64V747.83H0.950012V675.66ZM227.99 327.61H150.28L106.63 438.33L173.16 447.64L130.04 578.06L276.95 405.59L186.46 407.72L227.99 327.61ZM89.87 66.25H293.73V223.99H89.87V66.25Z" fill="#55a9ad"/>
</svg>`;

const carWashingIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="100" height="99" viewBox="0 0 100 99" fill="none">
<path d="M88.02 40.8L82.95 29.47C80.86 24.79 76.19 21.77 71.07 21.77H45.22C41.13 21.77 37.23 23.73 34.79 27L25.3 39.71L10.31 44.83C6.73 46.05 4.33 49.41 4.33 53.18V61.08C4.33 64.93 7.47 68.07 11.32 68.07H17.41C19.24 70.95 22.45 72.86 26.11 72.86C29.77 72.86 32.98 70.94 34.81 68.07H47.99C48.06 68.92 48.31 69.77 48.79 70.54L59.25 87.14C60.03 88.38 61.25 89.25 62.69 89.57C63.1 89.66 63.51 89.71 63.92 89.71C64.95 89.71 65.95 89.42 66.84 88.86L69.05 87.47L71.9 91.99C73.47 94.48 75.92 96.22 78.79 96.87C79.61 97.06 80.43 97.15 81.25 97.15C83.31 97.15 85.33 96.57 87.11 95.45L91.35 92.78C96.5 89.54 98.05 82.71 94.8 77.56L91.95 73.04L92.72 72.56C95.06 71.08 95.89 68.12 94.78 65.66C95.84 64.43 96.49 62.84 96.49 61.09V52.55C96.49 50.4 95.61 48.3 94.08 46.79L88.01 40.8H88.02ZM92.23 68.45C92.08 69.1 91.69 69.66 91.12 70.01L90.36 70.49L84.93 61.88C84.38 61 83.51 60.39 82.48 60.15C81.46 59.92 80.42 60.11 79.54 60.66C79.28 60.83 79.04 61.02 78.83 61.23L77.94 59.81C77.38 58.93 76.52 58.31 75.5 58.08C74.48 57.85 73.43 58.03 72.55 58.58C72.28 58.75 72.04 58.94 71.83 59.16C71.28 58.42 70.49 57.9 69.56 57.69C68.6 57.47 67.59 57.63 66.74 58.13C65.84 58.65 65.21 59.51 64.95 60.55C64.69 61.62 64.87 62.77 65.45 63.7L65.93 64.46C65.69 64.54 65.45 64.65 65.22 64.78C64.32 65.3 63.69 66.16 63.43 67.19C63.17 68.26 63.35 69.41 63.93 70.34L66.22 73.98C65.98 74.06 65.74 74.17 65.52 74.3C64.62 74.82 63.99 75.68 63.73 76.72C63.47 77.79 63.65 78.94 64.23 79.86L67.42 84.92L65.21 86.31C64.04 87.04 62.5 86.69 61.76 85.53L51.3 68.93C50.94 68.37 50.83 67.7 50.98 67.04C51.13 66.38 51.52 65.83 52.09 65.48L77.98 49.17C79.14 48.44 80.69 48.79 81.43 49.95L91.89 66.55C92.25 67.11 92.36 67.78 92.21 68.44L92.23 68.45ZM89.75 90.23L85.51 92.9C83.7 94.04 81.54 94.41 79.45 93.94C77.36 93.46 75.57 92.2 74.43 90.39L66.8 78.27C66.65 78.03 66.6 77.73 66.67 77.44C66.71 77.27 66.81 77.04 67.05 76.9C67.19 76.82 67.34 76.78 67.5 76.78C67.57 76.78 67.64 76.78 67.71 76.8C67.94 76.85 68.14 76.99 68.27 77.2L73.33 85.23C73.62 85.68 74.1 85.93 74.6 85.93C74.87 85.93 75.15 85.86 75.4 85.7C76.1 85.26 76.31 84.33 75.87 83.63L70.81 75.6L66.49 68.74C66.34 68.5 66.29 68.19 66.36 67.91C66.4 67.74 66.5 67.51 66.74 67.37C66.94 67.25 67.18 67.22 67.39 67.27C67.63 67.33 67.83 67.47 67.96 67.67L74.87 78.64C75.16 79.09 75.64 79.34 76.14 79.34C76.41 79.34 76.69 79.27 76.94 79.11C77.64 78.67 77.85 77.74 77.41 77.04L70.5 66.07L68 62.1C67.85 61.86 67.8 61.55 67.87 61.27C67.91 61.1 68.01 60.87 68.25 60.73C68.45 60.61 68.68 60.58 68.9 60.63C69.14 60.69 69.34 60.83 69.47 61.04L71.32 63.98L78.94 76.08C79.23 76.53 79.71 76.78 80.21 76.78C80.48 76.78 80.76 76.71 81.01 76.55C81.71 76.11 81.92 75.18 81.48 74.48L73.86 62.38C73.73 62.18 73.69 61.93 73.74 61.7C73.79 61.46 73.94 61.26 74.14 61.13C74.35 61 74.59 60.96 74.83 61.01C75.06 61.06 75.26 61.21 75.39 61.41L78.31 66.04L83.02 73.51C83.31 73.96 83.79 74.21 84.29 74.21C84.56 74.21 84.84 74.14 85.09 73.98C85.79 73.54 86 72.61 85.56 71.91L80.86 64.44C80.73 64.23 80.69 63.99 80.74 63.76C80.79 63.52 80.94 63.32 81.14 63.19C81.35 63.06 81.59 63.02 81.82 63.07C82.06 63.13 82.26 63.27 82.39 63.48L92.26 79.15C94.62 82.9 93.49 87.87 89.75 90.23ZM93.5 61.08C93.5 61.7 93.34 62.29 93.09 62.81L83.99 48.36C82.37 45.79 78.97 45.02 76.4 46.64L50.51 62.95C49.66 63.49 49.02 64.23 48.59 65.07H36.1C36.3 64.26 36.42 63.42 36.42 62.55C36.42 56.86 31.79 52.23 26.1 52.23C20.41 52.23 15.79 56.86 15.79 62.55C15.79 63.42 15.91 64.26 16.11 65.07H11.31C9.11 65.07 7.32 63.28 7.32 61.08V53.18C7.32 50.69 8.91 48.47 11.27 47.66L26.7 42.39C26.99 42.29 27.24 42.11 27.42 41.87L37.19 28.79C39.07 26.27 42.07 24.77 45.22 24.77H71.07C75.02 24.77 78.61 27.1 80.22 30.7L85.41 42.29C85.49 42.46 85.59 42.61 85.73 42.75L92 48.94C92.96 49.89 93.51 51.21 93.51 52.56V61.1L93.5 61.08Z" fill="#55a9ad"/>
<path d="M54.75 28.04H45.65C43.41 28.04 41.33 29.14 40.08 30.99L32.81 41.71C32.5 42.17 32.47 42.76 32.73 43.25C32.99 43.74 33.5 44.05 34.06 44.05H54.77C55.6 44.05 56.27 43.38 56.27 42.55V29.54C56.27 28.71 55.6 28.04 54.77 28.04H54.75Z" fill="#55a9ad"/>
<path d="M74.95 30.2C74.2 28.87 72.78 28.04 71.25 28.04H61.71C60.88 28.04 60.21 28.71 60.21 29.54V42.55C60.21 43.38 60.88 44.05 61.71 44.05H80.16C80.69 44.05 81.19 43.77 81.45 43.31C81.72 42.85 81.72 42.28 81.46 41.82L74.94 30.2H74.95Z" fill="#55a9ad"/>
<path d="M17.48 19.2C17.37 18.47 16.74 17.93 16 17.93C15.24 17.91 14.63 18.47 14.51 19.2C14.5 19.27 13.38 26.01 8.73 27.14C8.06 27.3 7.58 27.91 7.58 28.6C7.58 29.29 8.05 29.89 8.73 30.06C13.37 31.18 14.5 37.93 14.51 37.99C14.62 38.72 15.25 39.26 15.99 39.26C16.73 39.26 17.36 38.72 17.47 37.99C17.48 37.92 18.6 31.18 23.25 30.05C23.92 29.89 24.4 29.28 24.4 28.59C24.4 27.9 23.93 27.3 23.25 27.13C18.61 26.01 17.49 19.26 17.47 19.2H17.48ZM16 32.96C15.25 31.41 14.15 29.78 12.55 28.6C14.14 27.42 15.25 25.78 16 24.24C16.75 25.79 17.85 27.42 19.45 28.6C17.86 29.78 16.75 31.42 16 32.96Z" fill="#55a9ad"/>
<path d="M8.52 18.94C8.63 19.67 9.26 20.21 10 20.21C10.74 20.21 11.37 19.67 11.48 18.94C11.48 18.9 12.21 14.68 14.99 14.01C15.66 13.85 16.14 13.24 16.14 12.55C16.14 11.86 15.67 11.26 14.99 11.09C12.19 10.41 11.48 6.20001 11.48 6.16001C11.37 5.43001 10.74 4.89001 10 4.89001C9.26 4.89001 8.63 5.43001 8.52 6.15001C8.52 6.19001 7.8 10.41 5.01 11.09C4.34 11.25 3.86 11.86 3.86 12.55C3.86 13.24 4.33 13.84 5.01 14.01C7.81 14.69 8.52 18.9 8.52 18.94ZM10 10.64C10.4 11.32 10.91 11.98 11.55 12.55C10.92 13.12 10.41 13.78 10 14.46C9.6 13.78 9.09 13.12 8.45 12.55C9.08 11.98 9.59 11.32 10 10.64Z" fill="#55a9ad"/>
<path d="M28.38 29.29C29.12 29.29 29.75 28.75 29.86 28.02C29.87 27.93 31.3 19.31 37.32 17.85C37.99 17.69 38.47 17.08 38.47 16.39C38.47 15.7 38 15.1 37.32 14.93C31.3 13.47 29.88 4.85 29.86 4.77C29.75 4.04 29.12 3.5 28.38 3.5C27.64 3.5 27.01 4.04 26.9 4.77C26.89 4.86 25.46 13.48 19.44 14.94C18.77 15.1 18.29 15.71 18.29 16.4C18.29 17.09 18.76 17.69 19.44 17.86C25.46 19.32 26.88 27.94 26.9 28.02C27.01 28.75 27.64 29.29 28.38 29.29ZM28.38 10.11C29.35 12.32 30.89 14.78 33.3 16.4C30.89 18.02 29.35 20.49 28.38 22.69C27.41 20.48 25.87 18.02 23.46 16.4C25.87 14.78 27.41 12.31 28.38 10.11Z" fill="#55a9ad"/>
</svg>`;


const ServiceSelection = ({selectService, fuelDeliverySheetPositionSup, setFuelDeliverySheetSup, fuelDeliverySheetSup}) => {
    const [selectingService, setSelectingService] = useState(true);
    const [isFuelDeliverySheetOpened, setIsFuelDeliverySheetOpened] = useState(false);

    const openFuelDeliverySheet = () => {
        setFuelDeliverySheetSup(true);
        Animated.spring(fuelDeliverySheetPositionSup, {
          toValue: 0,
          friction: 5,
          useNativeDriver: false,
        }).start();
      };

    useEffect(() => {
        setSelectingService(selectService);
    }, [selectService]);
    

    return( !fuelDeliverySheetSup ?
        <Animatable.View
        animation={selectingService ? "fadeIn" : "fadeOut"}
        duration={200}
        style={{
        position: "absolute",
        bottom: 20,
        backgroundColor: "white",
        padding: 16,
        borderRadius: 12,
        height: height * 0.28,
        width: "90%",
        alignSelf: "center",
        }}
    >
        <Text
        style={{
            textAlign: "center",
            fontSize: 16,
            color: "#465559",
            marginTop: 5,
        }}
        >
        Select a service
        </Text>
        <View
        style={{
            flexDirection: "column",
            gap: 30,
            marginTop: 40,
            marginLeft: 20,
        }}
        >
        <TouchableOpacity
            style={{ flexDirection: "row", alignItems: "center", gap: 10 }}
            onPress={openFuelDeliverySheet}
        >
            <SvgXml xml={fuelIcon} width={35} height={35} />
            <View style={{ flexDirection: "column", gap: -3 }}>
            <Text style={{ fontWeight: "bold", fontSize: 16 }}>
                EV Charge
            </Text>
            <Text style={{ fontSize: 13, color: "#465559" }}>
                On-demand, anytime, anywhere
            </Text>
            </View>
        </TouchableOpacity>
        <TouchableOpacity
            style={{ flexDirection: "row", alignItems: "center", gap: 10 }}
        >
            <SvgXml xml={carWashingIcon} width={35} height={35} />
            <View style={{ flexDirection: "column", gap: -3 }}>
            <Text style={{ fontWeight: "bold", fontSize: 16 }}>Car Wash</Text>
            <Text style={{ fontSize: 13, color: "#465559" }}>
                Exterior and interior car cleaning
            </Text>
            </View>
        </TouchableOpacity>
        </View>
    </Animatable.View>
        : null
    )
}

export default ServiceSelection;